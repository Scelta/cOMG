#!/usr/bin/perl -w
use strict;
use Getopt::Long;
use Pod::Text;
use FindBin qw/$Bin/;

my ($gl,$ins,$list,$prefix,$help,$workpath);
GetOptions(
	"gl:s" =>\$gl,
	"ins:s"=>\$ins,
	"l:s"=>\$list,
	"p:s"=>\$prefix,
	"o:s"=>\$workpath,
	"h:s"=>\$help,
        );

chomp (my $pwd=`pwd`);
$workpath||=$pwd;
&usage unless ($gl && $ins && $list);

my $cmd = "$Bin/computeGeneAbun $gl $ins $list $workpath/$prefix\n";
print STDERR $cmd;`$cmd`;
print STDERR "reads abundance file built\n";

####### compress the results to save space ### 
`gzip -f $workpath/$prefix*.abundance`;

sub usage {
        print <<EOD;
Description: This program is used to produce IGC gene set profile.

Version 1.00 Feb 11,2014

Usage: perl $0 -i1 <reads_pair1.fq> -p <output file prefix> -o <output dir Name>

        Options:
	    -i1 <str>   the sample pair 1
	    -i2 <str>   the sample pair 2
	    -i3 <str>   the sample single 
		-par <str>	the parameters for soap, default as ",r=0,l=30,M=4,S,p=8,v=5,S,c=0.95" (if change, retain the first comma)
	    -ins <str>  the insrert size file, which contains sample name and insert size per row. e.g: Sample1	350
            -o  <str>   output dir Name
            -p  <str>   output file prefix
		-ab <int>	the abundance type u wanna build,default as "123" :
						1	reads abundance
						2	base abundance
						3	adjust abundance
	    -h  <str>   pod this help prefix
 data: 2015-3-26
 modified by linyuxiang\@genomics.cn
 Modified:	2016-01-07	fangchao\@genomics.cn

EOD
exit(1);
}

